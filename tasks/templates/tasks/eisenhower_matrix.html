<!-- tasks/templates/tasks/eisenhower_matrix.html -->
{% extends 'core/base.html' %}
{% load static %}

{% block title %}–ú–∞—Ç—Ä–∏—Ü–∞ –≠–π–∑–µ–Ω—Ö–∞—É—ç—Ä–∞{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'tasks/css/matrix.css' %}">
{% endblock %}

{% block content %}
<div class="matrix-container">
    <div class="matrix-header">
        <h1>–ú–∞—Ç—Ä–∏—Ü–∞ –≠–π–∑–µ–Ω—Ö–∞—É—ç—Ä–∞</h1>
        <p>–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –∑–∞–¥–∞—á–∏ –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–π—Ç–µ –∏—Ö –ø–æ –∫–≤–∞–¥—Ä–∞–Ω—Ç–∞–º</p>
    </div>

    <div class="matrix-layout">

        <!-- –õ–ï–í–ê–Ø –ö–û–õ–û–ù–ö–ê: –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á -->
        <div class="tasks-sidebar">
            <h3>–ú–æ–∏ –∑–∞–¥–∞—á–∏</h3>

            <!-- –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏ -->
            <div class="create-task-form">
                <form id="task-form" method="POST" action="{% url 'tasks:matrix' %}">
                    {% csrf_token %}
                    <input type="hidden" name="priority" value="1">
                    <input type="hidden" name="estimated_pomodoros" value="1">

                    <div class="form-group">
                        <input type="text" name="title" id="task-title-input" class="form-control"
                               placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏..." required>
                        <div class="error-message" id="title-error"></div>
                    </div>
                    <div class="form-group">
                        <textarea name="description" id="task-description-input" class="form-control"
                                  placeholder="–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" rows="2"></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary" id="create-task-btn">
                            + –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É
                        </button>
                    </div>
                </form>
            </div>

            <!-- –°–ø–∏—Å–æ–∫ –Ω–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á -->
            <div class="tasks-list" id="tasks-list">
                {% if unassigned_tasks %}
                    {% for task in unassigned_tasks %}
                    <div class="task-card"
                         data-task-id="{{ task.id }}"
                         draggable="true"
                         id="task-{{ task.id }}">
                        <div class="task-header">
                            <h4 class="task-title">{{ task.title }}</h4>
                            <div class="task-actions">
                                <button class="btn-edit" data-task-id="{{ task.id }}">‚úèÔ∏è</button>
                                <button class="btn-delete" data-task-id="{{ task.id }}">üóëÔ∏è</button>
                            </div>
                        </div>
                        {% if task.description %}
                        <p class="task-description">{{ task.description }}</p>
                        {% endif %}
                    </div>
                    {% endfor %}
                {% endif %}
            </div>
        </div>

        <!-- –ü–†–ê–í–ê–Ø –ö–û–õ–û–ù–ö–ê: –ú–∞—Ç—Ä–∏—Ü–∞ -->
        <div class="matrix-main">
            <div class="eisenhower-matrix">

                {% for quadrant in quadrants %}
                <div class="quadrant" style="border-color: {{ quadrant.color_code }};">
                    <div class="quadrant-header" style="background-color: {{ quadrant.color_code }};">
                        <h3>{{ quadrant.name }}</h3>
                    </div>
                    <div class="tasks-container"
                         id="quadrant-{{ quadrant.id }}"
                         data-quadrant-id="{{ quadrant.id }}">

                        {% for task in tasks %}
                            {% if task.quadrant_id == quadrant.id %}
                            <div class="task-card"
                                 data-task-id="{{ task.id }}"
                                 draggable="true">
                                <div class="task-header">
                                    <h4 class="task-title">{{ task.title }}</h4>
                                    <div class="task-actions">
                                        <button class="btn-edit" data-task-id="{{ task.id }}">‚úèÔ∏è</button>
                                        <button class="btn-delete" data-task-id="{{ task.id }}">üóëÔ∏è</button>
                                    </div>
                                </div>
                                {% if task.description %}
                                <p class="task-description">{{ task.description }}</p>
                                {% endif %}
                            </div>
                            {% endif %}
                        {% endfor %}


                    </div>
                </div>
                {% endfor %}

            </div>
        </div>

    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞—á–∏ -->
<div id="edit-task-modal" class="modal">
    <div class="modal-content">
        <button class="close">&times;</button>
        <div class="modal-header">
            <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É</h3>
        </div>
        <form id="edit-task-form">
            {% csrf_token %}
            <input type="hidden" id="edit-task-id">
            <div class="form-group">
                <label for="edit-task-title">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                <input type="text" id="edit-task-title" class="form-control" required>
                <div class="error-message" id="edit-title-error"></div>
            </div>
            <div class="form-group">
                <label for="edit-task-description">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                <textarea id="edit-task-description" class="form-control" rows="3"></textarea>
            </div>
            <div class="form-actions">
                <button type="submit" class="btn btn-primary" id="save-task-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button type="button" id="cancel-edit" class="btn btn-outline">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </form>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script src="{% static 'tasks/js/tasks.js' %}"></script>
{% endblock %}